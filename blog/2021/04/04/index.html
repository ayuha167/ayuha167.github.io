<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="https://ayuha167.github.io/css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>Octopress から Hugo へ移行</title>

  
  
  <link rel="stylesheet" href="https://ayuha167.github.io/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="https://ayuha167.github.io/css/fork-awesome.min.css">
  

  
  <link href="https://ayuha167.github.io/favicon.png" rel="icon">

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="[ライブ配信 esports eスポーツ ストリーマー authenticity コミュニティ]">
  <meta name="author" content="アユハ/Ayuha Nakamura">

  
  <meta name="generator" content="Hugo 0.82.0" />

  
  

  
  
    

  
  
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image:src" content="https://ayuha167.github.io/images/Hugo/TwitterCard.jpg"/>
  
  
  <meta name="twitter:title" content="Octopress から Hugo へ移行"/>
  <meta name="twitter:description" content="Octopress から Hugo へ移行しました"/>
  
  <meta name="twitter:domain" content="ayuha167.github.io"/>
  <meta name="twitter:creator" content="@ayuha167"/>


  
</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://ayuha167.github.io/">恋心は超グリーディ</a></h1>
    <h2>普段質問されることを文章起こした場所です。ライブ配信やゲームイベントにまつわるものです。もしくは、たまに筆者の趣味の文章が交じります。</h2>
</hgroup>
</header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="https://ayuha167.github.io/blog/2013/12/25/title/">» About me</option>
      
        <option value="https://ayuha167.github.io/">» Blog</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="https://ayuha167.github.io/blog/2013/12/25/title/" title="About me"  rel="noopener noreferrer">About me</a></li>
    
  
    
      <li><a href="https://ayuha167.github.io/" title="Blog">Blog</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="https://ayuha167.github.io/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:https://ayuha167.github.io/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Apr 4, 2021
     - 2 minute read 
     - <a href="https://ayuha167.github.io/blog/2021/04/04/#disqus_thread">Comments</a>

    
    
      - 
    
  </p>
  <h1 class="entry-title">
     Octopress から Hugo へ移行 
  </h1>
</header>


        <div class="entry-content">
          
          
          
            <nav id="TableOfContents">
  <ul>
    <li><a href="#themes">themes</a></li>
    <li><a href="#文字列置換">文字列置換</a></li>
    <li><a href="#パーマリンク">パーマリンク</a></li>
    <li><a href="#twitter-card">Twitter Card</a></li>
    <li><a href="#ツイートボタン">ツイートボタン</a></li>
    <li><a href="#table-of-content">Table of Content</a></li>
    <li><a href="#プレビュー">プレビュー</a></li>
  </ul>
</nav>
          
          <p>Octopress から Hugo へ移行しました</p>
<p>GitHub を用いてブログを公開する方式 Octopressだったのですが、
アップデートがされない → Octopress で入れたいプラグインがあって、そのために Ruby をアップデートしようとするとビルドできなくなる &hellip;というデッドロックに入り、Hugo 移行を決意しました。</p>
<p>こちらのページを参考にしました。</p>
<ul>
<li><a href="https://iriya-ufo.net/blog/2018/12/27/octopress-to-hugo/">https://iriya-ufo.net/blog/2018/12/27/octopress-to-hugo/</a></li>
<li><a href="https://gam0022.net/blog/2016/09/25/migrated-from-octopress-to-hugo/">https://gam0022.net/blog/2016/09/25/migrated-from-octopress-to-hugo/</a></li>
</ul>
<h2 id="themes">themes</h2>
<p>Octopress Hugo というものを使用し、同じデザインで戻って参りました。</p>
<p><a href="https://themes.gohugo.io/hugo-octopress/#twitter-card">https://themes.gohugo.io/hugo-octopress/#twitter-card</a></p>
<p>このページです。↑筆者へ：常にここに帰ってください。</p>
<h2 id="文字列置換">文字列置換</h2>
<p>Octopressでは見出しは「＃＃」でしたが、Hugo では「＃＃ 」にしないといけないため、こうした置換を一斉に行いました。</p>
<p>しかし、Mac の sed コマンドでだいぶ苦戦しました。最初は指示に従って：</p>
<pre><code> $ find . -type f -exec sed -i &quot;&quot; -e 's/##/## /g' {} \;
</code></pre><p>と入れたのですが、エラーが置きました。どうやら、 -type f だと .DS_Store ファイルも含めてしまうため、</p>
<ul>
<li>sed: -i may not be used with stdin</li>
<li>sed: RE error: illegal byte sequence</li>
</ul>
<p>といったエラーを吐くようです。そのため、-type f ではなく、 -name で .markdown 形式のファイルを一括指定しました。</p>
<p>$ find . -name *.markdown -exec sed -i &quot;&quot; -e &rsquo;s/##/## /g' {} ;</p>
<p>はえ〜</p>
<p>$ find . -name *.markdown -exec sed -i &quot;&quot; -e &rsquo;s/<!-- raw HTML omitted -->/<!-- raw HTML omitted -->/g' {} ;</p>
<p>Hugo はタイムスタンプの形式に指定（Hugoでは、&ldquo;2016-09-25T15:09:57&quot;のような形式のタイムスタンプでないとパースに失敗します）ので、こちらを適用↓</p>
<p>$ find . -name *.markdown -exec sed -i &quot;&rdquo; -e &rsquo;s/date: ([0-9]{4}-[0-9]{2}-[0-9]{2}) ([0-9]{2}:[0-9]{2})$/date: \1T\2:00+09:00/g' {} ;</p>
<h2 id="パーマリンク">パーマリンク</h2>
<p>基本的に Octopressでは
&lt;ブログ名&gt;.github.io./blog/YYYY/MM/DD/
というURLになるようにセットしていました。_comfig.yml で
permalink: /blog/:year/:month/:day/:title/
と入れていました。</p>
<p>これは Hugo では config.toml にて
[permalinks]
post = &ldquo;/blog/:year/:month/:day/&rdquo;
と書いておけば継承できます。</p>
<p>しかし、Hugo に移行するにあたり、私のブログに不都合がありました。URL を維持するために、</p>
<ul>
<li>私のブログには、いくつかURLが （同上）/YYYY/MM/DD/title とか （同上）/YYYY/MM/DD/Ch1 とかで終わるページがある。</li>
<li>Hugo でパーマリンクに /:slug/ を末尾に入れれば（ post = &ldquo;/blog/:year/:month/:day/:slug/&quot;）にすれば解決すると見せかけて、 :/slug は自動で勝手にタイトルをURLに入れてしまうため面倒</li>
</ul>
<p>という問題があったので、:slug は入れずに、例外的なブログ記事だけ、ファイル冒頭の段落（title: &ldquo;First Page&quot;などがある段落）に、
url: &ldquo;blog/2013/12/23/title/&rdquo;
のようにパーマリンクを書き、手動で設定しました。</p>
<h2 id="twitter-card">Twitter Card</h2>
<p><a href="https://themes.gohugo.io/hugo-octopress/#twitter-card">https://themes.gohugo.io/hugo-octopress/#twitter-card</a>
この設定をしておくべきです。</p>
<pre><code>
[params]
  # Twitter card config
  # Enable.
  twitterCardEnabled = true
  # Don't include the @.
  # twitterCardSite = 
  twitterCardDomain = &quot;parsiya.net&quot;
  # Don't include the @.
  twitterCardAuthor = &quot;CryptoGangsta&quot;

</code></pre><p>まずはこれを config.toml に書きます。ただ、これだけだと画像のURL指定が変になっているので、マニュアルにあった処理をします。
your-website/themes/Hugo-Octopress/layouts/partials/custom_twitter_card.html ファイルを、 your-website/layouts/partials/custom-twitter-card.html にコピペします。
で、</p>
<pre><code>    &lt;meta name=&quot;twitter:image:src&quot; 

</code></pre><p>ではじまる行がサムネイル(Twitter Card)を司っているので、ここを</p>
<pre><code>    &lt;meta name=&quot;twitter:image:src&quot; content=&quot;https://ayuha167.github.io/images/Hugo/TwitterCard.jpg&quot;/&gt;

</code></pre><p>に書き換えました。これをしておけば、後はページの最初の部分に</p>
<p>twitterImage: true</p>
<p>の項目を追加するだけでサムネイルが自動生成されます。</p>
<h2 id="ツイートボタン">ツイートボタン</h2>
<p>addThis という外部サービスを使いました。</p>
<p>ここを参考に。
<a href="https://gohugohq.com/partials/add-this-social-sharing/">https://gohugohq.com/partials/add-this-social-sharing/</a>
<a href="https://www.trhrkmk.com/posts/hugo-share-button-addthis/">https://www.trhrkmk.com/posts/hugo-share-button-addthis/</a></p>
<p>完全に指示通りではなく、themes/Hugo-Octopress/ の中で操作しました。
指示では /partials/ の中に addthis.html を作れとのことですが、私の場合は themes/Hugo-Octopress/layouts/partials の中に追加しました。</p>
<p>config.toml に追記し、</p>
<p>themes/Hugo-Octopress/layouts/partials/post_footer.html の中にテキトーに</p>
<!-- raw HTML omitted -->
<p>と書き加えたら起動しました。</p>
<h2 id="table-of-content">Table of Content</h2>
<p>今までやっていなかったんですが、</p>





<nav id="TableOfContents">
  <ul>
    <li><a href="#themes">themes</a></li>
    <li><a href="#文字列置換">文字列置換</a></li>
    <li><a href="#パーマリンク">パーマリンク</a></li>
    <li><a href="#twitter-card">Twitter Card</a></li>
    <li><a href="#ツイートボタン">ツイートボタン</a></li>
    <li><a href="#table-of-content">Table of Content</a></li>
    <li><a href="#プレビュー">プレビュー</a></li>
  </ul>
</nav>

<p>こうすれば目次（ToC）が生成出来るようになりました。これは便利。</p>
<p>##新記事を投稿</p>
<p>このコマンドで</p>
<p>$ hugo new blog</p>
<h2 id="プレビュー">プレビュー</h2>
<p>$ hugo server -D</p>
<p>で、localhost:1313</p>
<p>##移行</p>
<p>Hugo ディレクトリで GitHub の初期設定が必要です。</p>
<p><a href="https://prog-8.com/docs/git-env">https://prog-8.com/docs/git-env</a></p>
<p>元のリポジトリが ayuha167.github.io だったので、GitHub の Settings からテキトーに違う名前にして（ayuha1919.github.io など）、Rename を押します。</p>
<p>で、右上の＋ボタンを押して &ldquo;New Repository&rdquo; を作成。こちらの名前（Repository Name）を ayuha167.github.io にします。</p>
<p>このページを参考にpushしました↓
<a href="https://qiita.com/satzz/items/e24bd703fc04fb45f7ef">https://qiita.com/satzz/items/e24bd703fc04fb45f7ef</a></p>
<p>そこから、公開の準備に入ります。ターミナルを開きます。私の場合、ブログを書いているローカルディレクトリの名前が /ayuha167 なので、</p>
<pre><code>
$ cd ayuha167
$ git clone 【GitHubリポジトリのアドレス】

</code></pre><p>をします。【GitHubリポジトリのアドレス】は GitHub で「↓Code」ボタンから現れます。すると ayuha167/ayuha167.github.io というディレクトリが出来ます。</p>
<p>hugo コマンドを使うと、Hugo が作ってくれたページが /public ディレクトリ以下に生成されます。そのため、/pubglic 以下をリポジトリの gh-pages ブランチへ push します。ブランチを用意するところまでは：</p>
<pre><code>
$ hugo 
$ cd public
$ git init
$ git remote add origin git@github.com:ayuha167/ayuha167.github.io
$ git checkout -b gh-pages

</code></pre><p>これで準備は完了です。このあと、実際に push するには、</p>
<pre><code>
$ git add --all
$ git commit -m 'release `date '+%Y-%m-%d %H:%M’`'
$ git push origin gh-pages

</code></pre><p>です。これでページが公開されたはずです。</p>
<p>せっかちな人は index.html （私の場合は <a href="https://ayuha167.github.io/index.html">https://ayuha167.github.io/index.html</a>）にアクセスすると、すぐにチェック出来ます。</p>
<p>##備忘録</p>
<p>筆者へ。</p>
<p>新ポストを送るには、ブログのディレクトリ（/ayuha167）に入ってから、</p>
<pre><code>
$ hugo
$ cd public
$ git add --all
$ git commit -m'コメント'
$ git push origin gh-pages

</code></pre><p>を打たなければなりません。これが面倒なので、ブログのディレクトリに push.sh というシェルコマンドファイルを作りました。以下です：</p>
<pre><code>
#!/bin/sh

hugo

cd public
git add --all
git commit -m'push from push.sh'
git push origin gh-pages 

cd ..

</code></pre><p>そのため、内容をアップデートしましたら、ブログのディレクトリ直下で、</p>
<pre><code>$ sh push.sh

</code></pre><p>とやるだけでアップデート出来ます。（エラーチェックをするだけなら $ hugo や $ hugo server -D でも可。）</p>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">アユハ/Ayuha Nakamura</span></span>
    
    <time>Apr 4, 2021</time>
    
      <span class="categories">
        Tags:
        
          
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://ayuha167.github.io/blog/2021/02/21/" title="ヒーリングっど♥プリキュア 振り返り">ヒーリングっど♥プリキュア 振り返り</a>
    

    
  </p>
  
  <body>

  <div class="addthis_inline_share_toolbox"></div>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-606b1ae649209a1d" async></script>
​<script type="text/javascript">
    var addthis_config = addthis_config||{};
    addthis_config.data_track_addressbar = false;
    addthis_config.data_track_clickback = false;
</script>

  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-606b1ae649209a1d" async></script>


  </body>
  
  
    
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>こんにちは</h1>
    

    <p>
      
        アユハです。ゲーマーの生き方や考え方について、色々訊かれることが多いのでそれらをブログにまとめています。筆者プロフィールは<a href="https://ayuha167.github.io/blog/2013/12/25/title/">こちら</a>から。
      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      
      
      
      <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/ayuha167/" title="https://twitter.com/ayuha167/"><i class="fa fa-twitter fa-3x"></i></a>
      
         
      
      
      
      
      
      
      

    
    
    </li>
  </ul>

  

  
    
      <section class="odd">
        
          <h1>Sidebar Links</h1>
        
        
          <li>
            <a href="https://www.github.com/parsiya/hugo-octopress" title="This theme on Github" >This theme on Github</a>
          </li>
        
          <li>
            <a href="https://ayuha167.github.io/layouts/category/category.html" title="Taxonomy" >Taxonomy</a>
          </li>
        
      </section>
    
  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2021/04/04/">Octopress から Hugo へ移行</a>
              </li>
            
          
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2021/02/21/">ヒーリングっど♥プリキュア 振り返り</a>
              </li>
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2021/01/25/">スマホからTwitchへライブ配信 2021</a>
              </li>
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2021/01/13/">ゲーマーのコミュニティとは</a>
              </li>
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2020/12/20/">スマブラ勢は「終点固定アイテムなし」ではない</a>
              </li>
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2020/11/11/">Authenticity オーセンティシティ とは</a>
              </li>
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2020/10/27/">「いいね」を貰うためにゲームをする主義について</a>
              </li>
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2020/10/14/">映画『もののけ姫』普通の考察</a>
              </li>
            
          
            
              <li class="post">
                <a href="https://ayuha167.github.io/blog/2020/08/13/">ゲーム：公式大会と非公式大会</a>
              </li>
            
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2021 アユハ/Ayuha Nakamura - <a href="https://ayuha167.github.io/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    
    

    
      <script>
        var _gaq=[['_setAccount','UA-140679606-1'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
      </script>
    
  </body>
</html>

